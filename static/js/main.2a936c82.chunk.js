(this["webpackJsonphealth-pass"]=this["webpackJsonphealth-pass"]||[]).push([[0],{113:function(e,n){},223:function(e,n,t){},224:function(e,n,t){},359:function(e,n){},402:function(e,n,t){"use strict";t.r(n);var c=t(0),o=t.n(c),i=t(208),r=t.n(i),a=(t(223),t(9)),l=t(417),s=t(13),d=t(211),u=t.n(d),j=t(86),h=(t(224),t(213)),v=t(420),b=t(419),f=t(421),p=t(214),O=t.n(p),m=t(1),x=Object(s.a)("div")({border:"1px solid grey",borderRadius:"1rem"}),g=function(e){var n=e.img,t=Object(c.useState)(),o=Object(a.a)(t,2),i=o[0],r=o[1],s=Object(c.useState)(),d=Object(a.a)(s,2),u=d[0],h=d[1],p=Object(c.useState)(),g=Object(a.a)(p,2),S=g[0],w=g[1],y=Object(c.useState)(),k=Object(a.a)(y,2),C=k[0],z=k[1],D=Object(c.useState)(),N=Object(a.a)(D,2),T=N[0],R=N[1];Object(c.useEffect)((function(){C&&!i&&O()(C).then((function(e){var n=e.payload.vc.credentialSubject.fhirBundle.entry;if(n){var t=n.filter((function(e){return"Patient"===e.resource.resourceType}));t&&t.length>0&&r(t[0]);var c=n.filter((function(e){return"Immunization"===e.resource.resourceType})).sort((function(e,n){return new Date(e.resource.occurrenceDateTime)-new Date(n.resource.occurrenceDateTime)}));c&&c.length>0&&(h(c[0]),c.length>1&&w(c[1]))}})).catch((function(e){return console.log("Failed to decode QR Code")}))}),[C,i,r,h,w]);var F,P,W,I,L,B,E,A,U,Q,J,M,V,q=Object(c.useCallback)((function(){n&&!C&&j.a.scanImage(n).then((function(e){e.startsWith("shc:")?z(e):z(void 0)})).catch((function(e){return R(e)}))}),[n,C,z]);return Object(c.useEffect)((function(){q()}),[q]),n&&!C?Object(m.jsxs)(x,{children:[Object(m.jsx)("div",{children:"Failed to scan the QR code"}),Object(m.jsx)("div",{children:T}),Object(m.jsx)(l.a,{variant:"contained",onClick:q,children:"Retry"})]}):n||C?Object(m.jsxs)(x,{children:[Object(m.jsxs)(v.a,{children:[Object(m.jsx)(b.a,{sx:{fontSize:14},color:"text.grey",children:"Name"}),Object(m.jsx)(b.a,{variant:"h6",component:"p",children:"".concat(null===i||void 0===i||null===(F=i.resource)||void 0===F||null===(P=F.name[0])||void 0===P?void 0:P.given.map((function(e){return"".concat(e," ")}))," ").concat(null===i||void 0===i||null===(W=i.resource)||void 0===W||null===(I=W.name[0])||void 0===I?void 0:I.family)}),Object(m.jsx)(b.a,{sx:{fontSize:14},children:"Birthday"}),Object(m.jsx)(b.a,{variant:"h6",component:"p",children:null===i||void 0===i||null===(L=i.resource)||void 0===L?void 0:L.birthDate}),Object(m.jsx)(f.a,{style:{borderColor:"grey"}}),Object(m.jsx)(b.a,{sx:{fontSize:18},children:"First Shot"}),Object(m.jsx)(b.a,{sx:{fontSize:14},children:"Date"}),Object(m.jsx)(b.a,{variant:"h7",component:"p",children:null===u||void 0===u||null===(B=u.resource)||void 0===B?void 0:B.occurrenceDateTime}),Object(m.jsx)(b.a,{sx:{fontSize:14},children:"Lot Number"}),Object(m.jsx)(b.a,{variant:"h7",component:"p",children:null===u||void 0===u||null===(E=u.resource)||void 0===E?void 0:E.lotNumber}),Object(m.jsx)(b.a,{sx:{fontSize:14},children:"Taken By"}),Object(m.jsx)(b.a,{variant:"h7",component:"p",children:null===u||void 0===u||null===(A=u.resource)||void 0===A?void 0:A.performer.map((function(e){return"".concat(e.actor.display,",")}))}),Object(m.jsx)(b.a,{sx:{fontSize:14},children:"Status"}),Object(m.jsx)(b.a,{variant:"h7",component:"p",children:null===u||void 0===u||null===(U=u.resource)||void 0===U?void 0:U.status}),Object(m.jsx)(f.a,{style:{borderColor:"grey"}}),Object(m.jsx)(b.a,{sx:{fontSize:18},children:"Second Shot"}),Object(m.jsx)(b.a,{sx:{fontSize:14},children:"Date"}),Object(m.jsx)(b.a,{variant:"h7",component:"p",children:null===S||void 0===S||null===(Q=S.resource)||void 0===Q?void 0:Q.occurrenceDateTime}),Object(m.jsx)(b.a,{sx:{fontSize:14},children:"Lot Number"}),Object(m.jsx)(b.a,{variant:"h7",component:"p",children:null===S||void 0===S||null===(J=S.resource)||void 0===J?void 0:J.lotNumber}),Object(m.jsx)(b.a,{sx:{fontSize:14},children:"Taken By"}),Object(m.jsx)(b.a,{variant:"h7",component:"p",children:null===S||void 0===S||null===(M=S.resource)||void 0===M?void 0:M.performer.map((function(e){return"".concat(e.actor.display,",")}))}),Object(m.jsx)(b.a,{sx:{fontSize:14},children:"Status"}),Object(m.jsx)(b.a,{variant:"h7",component:"p",children:null===S||void 0===S||null===(V=S.resource)||void 0===V?void 0:V.status})]}),Object(m.jsx)("div",{className:"bar"})]}):Object(m.jsx)(x,{children:"Loading..."})};j.a.WORKER_PATH=h.a;var S=Object(s.a)("input")({display:"none"}),w=function(){var e=localStorage.getItem("imagePath"),n=Object(c.useState)(!1),t=Object(a.a)(n,2),o=t[0],i=t[1],r=Object(c.useState)(e),s=Object(a.a)(r,2),d=s[0],j=s[1],h=Object(c.useState)(),v=Object(a.a)(h,2),b=v[0],f=v[1],p=Object(c.useMemo)((function(){var e=new FileReader;return e.onload=function(){e.result?(j(e.result),localStorage.setItem("imagePath",e.result)):f("Invalid QR Code")},e}),[j,f]),O=Object(c.useCallback)((function(e){p.readAsDataURL(e.target.files[0]),f(void 0)}),[p,f]),x=Object(c.useCallback)((function(){d&&(confirm("Remove your Vaccine Card?")&&(j(void 0),f(void 0),i(!1),localStorage.removeItem("imagePath")))}),[d,j,f,i]),w=Object(c.useCallback)((function(){i(!o)}),[o,i]);return Object(m.jsxs)("div",{id:"app",children:[Object(m.jsx)("h1",{id:"app-title",children:"Vaccine Passport"}),!d&&Object(m.jsxs)("label",{className:"center",htmlFor:"contained-button-file",children:[Object(m.jsx)(S,{onChange:O,accept:"image/*",id:"contained-button-file",type:"file"}),Object(m.jsx)(l.a,{variant:"contained",component:"span",children:"Open"})]}),!!b&&Object(m.jsx)("p",{className:"bottom",style:{color:"red"},children:b}),!!d&&Object(m.jsx)("div",{id:"flipper",className:"center",children:Object(m.jsxs)(u.a,{isFlipped:o,flipDirection:"horizontal",children:[Object(m.jsx)("div",{onClick:w,className:"flipper-container",children:Object(m.jsx)("img",{src:d,alt:"covid vaccine qr code"})}),Object(m.jsx)("div",{onClick:w,className:"flipper-container",children:Object(m.jsx)(g,{img:d})})]})}),!!d&&Object(m.jsx)(l.a,{id:"delete",variant:"contained",color:"error",onClick:x,children:"Delete"})]})},y=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,422)).then((function(n){var t=n.getCLS,c=n.getFID,o=n.getFCP,i=n.getLCP,r=n.getTTFB;t(e),c(e),o(e),i(e),r(e)}))},k=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function C(e,n){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}r.a.render(Object(m.jsx)(o.a.StrictMode,{children:Object(m.jsx)(w,{})}),document.getElementById("root")),y(),function(e){if("serviceWorker"in navigator){if(new URL("/vaccine-passport",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat("/vaccine-passport","/service-worker.js");k?(!function(e,n){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var c=t.headers.get("content-type");404===t.status||null!=c&&-1===c.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):C(e,n)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):C(n,e)}))}}()}},[[402,1,2]]]);
//# sourceMappingURL=main.2a936c82.chunk.js.map